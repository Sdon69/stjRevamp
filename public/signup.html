<script src="deviceCheck.js"></script>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
<style>

* { box-sizing:border-box; }

/* basic stylings ------------------------------------------ */
body 				 { background:url(https://scotch.io/wp-content/uploads/2014/07/61.jpg); }

h2 		 {
  text-align:center;
  margin-bottom:50px;
}
h2 small {
  font-weight:normal;
  color:#888;
  display:block;
}
.footer 	{ text-align:center; }
.footer a  { color:#53B2C8; }

/* form starting stylings ------------------------------- */
.group 			  {
  position:relative;
  margin-bottom:45px;
}
input 				{
  font-size:18px;
  padding:10px 10px 10px 5px;
  width:100%;
  border:none;
  border-bottom:1px solid #757575;
}
input:focus 		{ outline:none; }

/* LABEL ======================================= */
label 				 {
  color:#999;
  font-size:18px;
  font-weight:normal;
  position:absolute;
  pointer-events:none;
  left:5px;
  top:10px;
  transition:0.2s ease all;
  -moz-transition:0.2s ease all;
  -webkit-transition:0.2s ease all;
}

/* active state */
input:focus ~ label, input:valid ~ label 		{
  top:-20px;
  font-size:14px;
  color:#3f8acd;
}

/* BOTTOM BARS ================================= */
.bar 	{ position:relative; display:block; width:100%; }
.bar:before, .bar:after 	{
  content:'';
  height:2px;
  width:0;
  bottom:1px;
  position:absolute;
  background:#3f8acd;
  transition:0.2s ease all;
  -moz-transition:0.2s ease all;
  -webkit-transition:0.2s ease all;
}
.bar:before {
  left:50%;
}
.bar:after {
  right:50%;
}

/* active state */
input:focus ~ .bar:before, input:focus ~ .bar:after {
  width:50%;
}

/* HIGHLIGHTER ================================== */
.highlight {
  position:absolute;
  height:60%;
  width:100px;
  top:25%;
  left:0;
  pointer-events:none;
  opacity:0.5;
}

/* active state */
input:focus ~ .highlight {
  -webkit-animation:inputHighlighter 0.3s ease;
  -moz-animation:inputHighlighter 0.3s ease;
  animation:inputHighlighter 0.3s ease;
}

/* ANIMATIONS ================ */
@-webkit-keyframes inputHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}
@-moz-keyframes inputHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}
@keyframes inputHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}

select 				{
  font-size:18px;
  padding:10px 10px 10px 5px;
  width:100%;
  border:none;
  border-bottom:1px solid #757575;
  -webkit-appearance: none;
}
select:focus 		{ outline:none; }

/* LABEL ======================================= */
label 				 {
  color:#999;
  font-size:18px;
  font-weight:normal;
  position:absolute;
  pointer-events:none;
  left:5px;
  top:10px;
  transition:0.2s ease all;
  -moz-transition:0.2s ease all;
  -webkit-transition:0.2s ease all;
}

/* active state */
select:focus ~ label, select:valid ~ label 		{
  top:-20px;
  font-size:14px;
  color:#3f8acd;
}

/* BOTTOM BARS ================================= */
.bar 	{ position:relative; display:block; width:100%; }
.bar:before, .bar:after 	{
  content:'';
  height:2px;
  width:0;
  bottom:1px;
  position:absolute;
  background:#3f8acd;
  transition:0.2s ease all;
  -moz-transition:0.2s ease all;
  -webkit-transition:0.2s ease all;
}
.bar:before {
  left:50%;
}
.bar:after {
  right:50%;
}

/* active state */
select:focus ~ .bar:before, select:focus ~ .bar:after {
  width:50%;
}

/* HIGHLIGHTER ================================== */
.highlight {
  position:absolute;
  height:60%;
  width:100px;
  top:25%;
  left:0;
  pointer-events:none;
  opacity:0.5;
}

/* active state */
select:focus ~ .highlight {
  -webkit-animation:selectHighlighter 0.3s ease;
  -moz-animation:selectHighlighter 0.3s ease;
  animation:selectHighlighter 0.3s ease;
}

/* ANIMATIONS ================ */
@-webkit-keyframes selectHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}
@-moz-keyframes selectHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}
@keyframes selectHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}


</style>
</head>

<button id="authorize-button" style="display: none;">Authorize</button>
<button id="signout-button" style="display: none;">Sign Out</button>
<div id="loadingDiv" style="position:fixed; height:100%; width:100%; background:#80141516; display:none;"><div style="position:fixed; width:20%; top:50%; left:40%; background:#ffffff;"><table ><tr><td><img src="loading.gif"></td><td> Loading...</td></tr></table></div>
</div>

  <!-- Show spreadsheets -->
  <font face="roboto">
  <div style="background:#ffffff; padding:20px; height:100%;">

        <form  name='event'>
    <div class="form-style-2">

              <div class="group">
    <input type='text' placeholder="First Name"    name='firstName' id="firstNameField" maxlength="20"/>
    <span class="highlight"></span>
    <span class="bar"></span>
</div>  <div class="group">
    <input type='text' placeholder="Last Name"  name='lastName' maxlength="20" id="lastNameField" >
    <span class="highlight"></span>
    <span class="bar"></span>
</div>  <div class="group">
        <input type='text' placeholder="User Id"  name='userId' maxlength="20"  id="userIdField" >
        <span class="highlight"></span>
        <span class="bar"></span>
    </div>  <div class="group">
<input type='password' placeholder="Password"  name='password' maxlength="20"  id="passwordField" >
<span class="highlight"></span>
<span class="bar"></span>
</div>  <div class="group">
    <input type='password' placeholder="Confirm Password"  name='confirmPassword' maxlength="20"  id="confirmPasswordField" ><br>
    <span class="highlight"></span>
    <span class="bar"></span>
</div>  <span class="highlight"></span>
    <span class="bar"></span>
</div>
  <div class="group">
    <input type='text' placeholder="Email Address"    name='emailAddress' maxlength="40" id="emailAddressField"  /><br>
    <span class="highlight"></span>
    <span class="bar"></span>
  </div>  <div class="group">
      <input type='tel' placeholder="Phone No."    name='phoneNo' maxlength="10" id="phoneNoField"  /><br>
      <span class="highlight"></span>
      <span class="bar"></span>
    </div>

      <a href='signup' style="text-decoration:none;"><div align='center' style="color:#15446e;font-weight:500;">Already a member ? Sign in</div></a>
          <br><br>
    <button type="button" value="Submit"  onclick="check()"  style="background: linear-gradient(0deg, #15446e, #408bce); color:#FFFFFF; height:10%; width:100%;font-size:26;"    >Submit
</button>


</div>





          </div>
        </form>
        <br><br>
      <span class="mdl-list__item-secondary-action" style="position:relative; ">

        <button  class="mdl-button mdl-js-button mdl-button--raised
                       mdl-js-ripple-effect mdl-button--colored"
                rel="writeUserId" type="button" id='create'  style="position:relative;visibility:collapse;">Create</button>
                <button  class="mdl-button mdl-js-button mdl-button--raised
                               mdl-js-ripple-effect mdl-button--colored"
                        rel="getDataForUserId" type="button" id='getData'  style="position:relative;visibility:collapse;">Create</button>

</div></font>





<script>




 var input = document.getElementById("firstNameField");
input.addEventListener("keyup", function(event) {
    event.preventDefault();
    if (event.keyCode === 13) {
        check();
    }
});

var input = document.getElementById("lastNameField");
input.addEventListener("keyup", function(event) {
   event.preventDefault();
   if (event.keyCode === 13) {
       check();
   }
});

var input = document.getElementById("userIdField");
input.addEventListener("keyup", function(event) {
   event.preventDefault();
   if (event.keyCode === 13) {
       check();
   }
});

var input = document.getElementById("passwordField");
input.addEventListener("keyup", function(event) {
   event.preventDefault();
   if (event.keyCode === 13) {
       check();
   }
});

var input = document.getElementById("confirmPasswordField");
input.addEventListener("keyup", function(event) {
   event.preventDefault();
   if (event.keyCode === 13) {
       check();
   }
});

var input = document.getElementById("emailAddressField");
input.addEventListener("keyup", function(event) {
   event.preventDefault();
   if (event.keyCode === 13) {
       check();
   }
});

var input = document.getElementById("phoneNoField");
input.addEventListener("keyup", function(event) {
   event.preventDefault();
   if (event.keyCode === 13) {
       check();
   }
});




function check()
{


  var firstName = document.event.firstName.value;

  var lastName = document.event.lastName.value;

  var userId = document.event.userId.value;

  var password = document.event.password.value;

  var confirmPassword = document.event.confirmPassword.value;


  var emailAddress = document.event.emailAddress.value;

  var phoneNo = document.event.phoneNo.value;



if(firstName.length < 1)
{

  alert('Enter First Name');
}
else if (lastName.length < 1) {
    alert('Enter Last Name');
}else if (userId.length < 1) {
    alert('Enter User Id');
}else if (userId.length < 6) {
    alert('Minimum size of User Id is 6 characters');
}else if (password.length < 1) {
    alert('Enter Password');
}else if (password.length < 8 ) {
    alert('Minimum size of Password is 8 Characters');
}else if(password != confirmPassword)
{
    alert('Passwords do not match ');
}else if (emailAddress.length < 1) {
    alert('Enter Email Address');
}else if (!emailAddress.includes('@')) {
    alert('Invalid Email');
}else if (!emailAddress.includes('.')) {
    alert('Invalid Email');
}else if (phoneNo.length < 10) {
    alert('Enter Valid Phone No');
}







else{

  var userId = document.event.userId.value;


//Saving Data using Html Web Storage

  if (typeof(Storage) !== "undefined") {
      // Code for localStorage/sessionStorage.

      localStorage.setItem("transferFirstName", firstName );
      localStorage.setItem("transferLastName", lastName );
      localStorage.setItem("transferUserId", userId);
      localStorage.setItem("transferPassword", password);
      localStorage.setItem("transferEmailAddress", emailAddress);
      localStorage.setItem("transferPhoneNo", phoneNo);
      listMajors();

  } else {
      // Sorry! No Web Storage support..
        document.write('Your phone is not compatible with app');
  }







}







}




</script>

<script type="text/javascript">


  // Client ID and API key from the Developer Console
  var CLIENT_ID = '494373301552-ud7mvkhosmjkbbv4th3qelqij6jatfkg.apps.googleusercontent.com';
  var API_KEY = 'AIzaSyAPAiPku7AqUy6mzyI-QVGe1cobzv8Afmw';

  // Array of API discovery doc URLs for APIs used by the quickstart
  var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

  // Authorization scopes required by the API; multiple scopes can be
  // included, separated by spaces.
  var SCOPES = "https://www.googleapis.com/auth/spreadsheets";

  var authorizeButton = document.getElementById('authorize-button');
  var signoutButton = document.getElementById('signout-button');

  /**
   *  On load, called to load the auth2 library and API client library.
   */
  function handleClientLoad() {
    gapi.load('client:auth2', initClient);
  }

  /**
   *  Initializes the API client library and sets up sign-in state
   *  listeners.
   */
  function initClient() {
    gapi.client.init({
      apiKey: API_KEY,
      clientId: CLIENT_ID,
      discoveryDocs: DISCOVERY_DOCS,
      scope: SCOPES
    }).then(function () {
      // Listen for sign-in state changes.
      gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

      // Handle the initial sign-in state.
      updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
      authorizeButton.onclick = handleAuthClick;
      signoutButton.onclick = handleSignoutClick;
    });
  }

  /**
   *  Called when the signed in status changes, to update the UI
   *  appropriately. After a sign-in, the API is called.
   */
  function updateSigninStatus(isSignedIn) {
    if (isSignedIn) {
      authorizeButton.style.display = 'none';
      signoutButton.style.display = 'none';
      // listMajors();
    } else {
      authorizeButton.style.display = 'none';
      signoutButton.style.display = 'none';
    }
  }

  /**
   *  Sign in the user upon button click.
   */
  function handleAuthClick(event) {
    gapi.auth2.getAuthInstance().signIn();
  }

  /**
   *  Sign out the user upon button click.
   */
  function handleSignoutClick(event) {
    gapi.auth2.getAuthInstance().signOut();
  }

  /**
   * Append a pre element to the body containing the given message
   * as its text node. Used to display the results of the API call.
   *
   * @param {string} message Text to be placed in pre element.
   */
  function appendPre(message) {
    var pre = document.getElementById('content');
    var textContent = document.createTextNode(message + '\n');
    pre.appendChild(textContent);
  }

  /**
   * Print the names and majors of students in a sample spreadsheet:
   * https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
   */

   var loadedFirstName;
   var loadedLastName;
   var loadedUserId;
   var loadedPassword;
   var loadedEmailAddress;
   var loadedPhoneNo;


     function listMajors() {
  document.getElementById("loadingDiv").style = "position:fixed; height:100%; width:100%; background:#80141516; display:block;" ;
       loadedFirstName =    localStorage.getItem("transferFirstName")
       loadedLastName =     localStorage.getItem("transferLastName")
       loadedUserId =       localStorage.getItem("transferUserId")
       loadedPassword =     localStorage.getItem("transferPassword")
       loadedEmailAddress = localStorage.getItem("transferEmailAddress")
       loadedPhoneNo =      localStorage.getItem("transferPhoneNo")
    var a = 2;
    gapi.client.sheets.spreadsheets.values.get({
      spreadsheetId: '1wW2WXPzQnS0uZrZmhe-3OsHMSIjx3SfSRJQp0pUbqkQ',
      range: 'Teacher Data!A2:F',
       }).then(function(response) {
         var range = response.result;
         if (range.values.length > 0) {
           for (i = 0; i < range.values.length; i++) {
             var row = range.values[i];
             // Print columns A and E, which correspond to indices 0 and 4.

             var userIdRetrieved = row[0];

             if(loadedUserId == userIdRetrieved)
             {
                document.getElementById("loadingDiv").style = "display:none;";
               alert('ID already taken');
               break;
             }





rangeImported =  "Teacher Data!".concat("A" + ++a + ":S");
           }
           if(loadedUserId != userIdRetrieved)
           {
             
            updateInfo(loadedUserId,loadedPassword,loadedFirstName,loadedLastName,loadedEmailAddress,loadedPhoneNo,rangeImported);

          }
         } else {
            document.getElementById("loadingDiv").style = "display:none;";
           alert('No data found.');
         }
       }, function(response) {
          document.getElementById("loadingDiv").style = "display:none;";
         alert('Error: ' + response.result.error.message);
       });
 document.getElementById("loadingDiv").style = "display:none;";

}
function updateInfo(importedUserId,importedPassword,importedFirstName,importedLastName,importedEmail,importedPhoneNo,rangeImported)
{
     gapi.client.sheets.spreadsheets.values.update({
       spreadsheetId: '1wW2WXPzQnS0uZrZmhe-3OsHMSIjx3SfSRJQp0pUbqkQ',
       range: rangeImported,
       valueInputOption: "USER_ENTERED",
       resource:  {
                  values: [ [importedUserId,importedPassword,importedFirstName,importedLastName,importedEmail,importedPhoneNo]]
                }
     }).then(function(response) {

       localStorage.setItem("firstName", loadedFirstName);
       localStorage.setItem("firstName", loadedFirstName);
       localStorage.setItem("lastname", loadedLastName);
       localStorage.setItem("userId", loadedUserId);
       localStorage.setItem("password", loadedPassword);
       localStorage.setItem("emailAddress", loadedEmailAddress);
       localStorage.setItem("phoneNo", loadedPhoneNo);
       localStorage.setItem("signup", 'true');
         document.getElementById("loadingDiv").style = "display:none;";
       window.location.href = "/";
       var range = response.result;
       if (range.values.length > 0) {


       } else {
         document.write('No data found.');
       }
     }, function(response) {
       document.write('Error: ' + response.result.error.message);
     });



}


</script>

<script async defer src="https://apis.google.com/js/api.js"
  onload="this.onload=function(){};handleClientLoad()"
  onreadystatechange="if (this.readyState === 'complete') this.onload()">
</script>
